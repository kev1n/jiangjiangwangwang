<html>
  <head>
    <title>WebTerm</title>
    <script src="
    https://cdn.jsdelivr.net/npm/xterm@5.1.0/lib/xterm.min.js
    "></script>
    <script src="/static/js/filemanager.js"></script>
    <link rel="stylesheet" href="/static/css/xterm.css" />
    <link rel="stylesheet" href="/static/css/style.css" />
    <!--import bootstrap cdn-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

  </head>
  <body>
    <button id="toggle-button" onclick="openTerminal(8000)">Open Terminal</button>
    <div width="500" height="500" id="terminal"></div>

    <h1>Current Path</h1>
    {% for path in currentPath %}
      <span onclick='changeDirectory("{{username}}", "{{paths[loop.index - 1]}}")'>{{path}} > </span>
    {% endfor %}

    <!--Search form-->
    <h1>Search for a file</h1>
    <form action="/search" method="POST">
      <!--Invisible username-->
      <input type="text" id="username" name="username" value="{{username}}" style="display: none;">
      <label for="filename">Filename</label>
      <input type="text" id="filename" name="filename" placeholder="Search">
      <button type="submit">Search</button>
    </form>
    <h1>Files</h1>

    <h2>Create a file</h2>
    <textarea width="500" height="500" id="create-file"></textarea>
    <label for="file-form">File Name</label>
    <input type="text" id="create-file-name" placeholder="File Name">
    <button onclick='createFile("{{username}}")'>Create File</button>
    

    {% for i in files %}
      <p onclick='getContentsOfFile("{{username}}", "{{i}}")'>{{i}}</p>
      <button onclick='deleteFile("{{username}}", "{{i}}")'>Delete</button>
      
      <button onclick='populateModalContents("{{username}}", "{{i}}")' type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-{{i}}">Edit</button>
      
      <!-- Modal -->
      <div class="modal fade" id="modal-{{i}}" tabindex="-1" aria-labelledby="modal-{{i}}Label" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modal-{{i}}Label">Modal title</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <!--We put the contents of the file in this textarea-->
              <textarea id="modal-{{i}}-contents">

              </textarea>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button onclick='editFile("{{username}}", "{{i}}")' type="button" class="btn btn-primary" data-bs-dismiss="modal">Save changes</button>
            </div>
          </div>
        </div>
      </div>

      <br>
      <!-- rename the file form-->
      <label for="rename">Rename</label>
      <input type="text" id="file-form-{{i}}" name="rename" placeholder="New Name">
      <button onclick='renameFile("{{username}}", "{{i}}")'>Rename</button>
    {% endfor %}
    <h1>Folders</h1>


    <h2>Create a folder</h2>
    <label for="folder-form">Folder Name</label>
    <input type="text" id="create-folder-name" placeholder="Folder Name">
    <button onclick='createDirectory("{{username}}")'>Create Folder</button>



    <p onclick='changeDirectory("{{username}}", "..")'>..</p>
    {% for i in folders %}
      <p onclick='changeDirectory("{{username}}", "{{i}}")'>{{i}}</p>
    {% endfor %}

    <script src="/static/js/server.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
  </body>
</html>